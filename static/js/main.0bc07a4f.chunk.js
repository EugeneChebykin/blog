(this["webpackJsonpblog-platform"]=this["webpackJsonpblog-platform"]||[]).push([[0],{245:function(e,t,a){e.exports=a(494)},249:function(e,t,a){},253:function(e,t,a){},494:function(e,t,a){"use strict";a.r(t);var n,r=a(0),l=a.n(r),o=a(4),s=a.n(o),c=(a(249),a(52)),i=a(31),u=(a(253),a(254),a(225)),m=a(496),d=a(499),p=a(62),h=a(38),E=a.n(h),g=a(501),b=a(226),f=a(227),v=a.n(f),S=(localStorage.getItem("user")||{}).token,w=S?{Autorization:"Bearer ".concat(S)}:{},y=v.a.create({baseURL:"http://karo-dev.ru:3000/api/",headers:Object(b.a)({},w,{"Content-type":"application/json"})}),O=function(e){var t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=JSON.stringify({user:e}),n.next=3,E.a.awrap(y.post("/users/login",t));case 3:return a=n.sent,localStorage.setItem("user",JSON.stringify(a.data.user)),n.abrupt("return",a.data.user);case 6:case"end":return n.stop()}}))},I=function(e){var t,a;return E.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=JSON.stringify({user:e}),n.next=3,E.a.awrap(y.post("/users",t));case 3:return a=n.sent,n.abrupt("return",a.data.user);case 5:case"end":return n.stop()}}))},j=a(23),x=Object(j.a)(),R=Object(g.a)("USER_LOGIN_REQUEST"),_=Object(g.a)("USER_LOGIN_SUCCESS"),T=Object(g.a)("USER_LOGIN_FAILURE"),U=Object(g.a)("USER_LOGOUT"),C=Object(g.a)("USER_REGISTR_REQUEST"),k=Object(g.a)("USER_REGISTR_SUCCESS"),L=Object(g.a)("USER_REGISTR_FAILURE"),N=Object(c.g)((function(e){var t=Object(i.c)((function(e){return e.userReducer})).loggedIn,a=Object(i.b)(),n=e.location;return l.a.createElement(d.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:[n.pathname],selectedKeys:[n.pathname],style:{lineHeight:"64px",display:"flex"}},l.a.createElement(d.a.Item,{key:"/home"},l.a.createElement(p.b,{to:"/home"},"Home")),!t&&l.a.createElement(d.a.Item,{key:"/login",style:{marginLeft:"auto"}},l.a.createElement(p.b,{to:"/login"},"Login")),t&&l.a.createElement(d.a.Item,{style:{marginLeft:"auto"},onClick:function(){return a(U())}},"Log out"))})),B=function(){var e=JSON.parse(localStorage.getItem("user"));return l.a.createElement("h1",null,e&&"Hello ".concat(e.username))},M=a(117),q=a(42),F=a(497),G=a(500),J=a(15),A=a(163),D=q.object().shape({email:q.string().email("Must be a valid email address").required("Email is required"),password:q.string().required("Password is required")}),H=function(){var e=Object(i.b)();return l.a.createElement(M.a,{initialValues:{email:"",password:""},validationSchema:D,onSubmit:function(t,a){var n,r=a.setSubmitting,l=a.resetForm;r(!0),e((n=t,function(e){var t;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e(R()),a.prev=1,a.next=4,E.a.awrap(O(n));case 4:t=a.sent,e(_({user:t})),x.push("/home"),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),e(T(a.t0));case 12:case"end":return a.stop()}}),null,null,[[1,9]])})),r(!1),l()}},(function(e){var t=e.values,a=e.errors,n=e.touched,r=e.isSubmitting,o=e.handleChange,s=e.handleBlur,c=e.handleSubmit;return l.a.createElement(F.a,{onSubmit:c,style:{marginTop:"70px",width:"300px"}},l.a.createElement(F.a.Item,{validateStatus:n.email&&a.email?"error":null,help:n.email&&a.email?a.email:null},l.a.createElement(G.a,{type:"email",id:"email",prefix:l.a.createElement(J.a,{type:"mail"}),placeholder:"Enter an email",value:t.email,onChange:o,onBlur:s})),l.a.createElement(F.a.Item,{validateStatus:n.password&&a.password?"error":null,help:n.password&&a.password?a.password:null},l.a.createElement(G.a,{type:"password",id:"password",prefix:l.a.createElement(J.a,{type:"lock"}),placeholder:"Enter a password",value:t.password,onChange:o,onBlur:s})),l.a.createElement(F.a.Item,null,l.a.createElement(A.a,{style:{width:"100%"},type:"primary",htmlType:"submit",disabled:r},"Log in"),"Or ",l.a.createElement(p.a,{to:"/signup"},"register now!")))}))},V=function(){return l.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},l.a.createElement(H,null))},X=q.object().shape({username:q.string().min(1,"Must have a character").max(50,"Must be shorter than 50").required("Must enter a name"),email:q.string().email("Must be a valid email address").required("Email is required"),password:q.string().min(8,"Must be longer than 8").max(40,"Must be shorter than 40").matches(/[0-9]/,"Must have at least one digit").matches(/[A-Z]/,"Must have at least one uppercase character").matches(/^[a-zA-Z0-9]{8,}$/,"Must have only letters and digits").required("Password is required")}),z=function(){var e=Object(i.b)();return l.a.createElement(M.a,{initialValues:{username:"",email:"",password:""},validationSchema:X,onSubmit:function(t,a){var n,r=a.setSubmitting,l=a.resetForm;r(!0),e((n=t,function(e){var t;return E.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e(C()),a.prev=1,a.next=4,E.a.awrap(I(n));case 4:t=a.sent,e(k({user:t})),x.push("/login"),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),e(L(a.t0));case 12:case"end":return a.stop()}}),null,null,[[1,9]])})),r(!1),l()}},(function(e){var t=e.values,a=e.errors,n=e.touched,r=e.isSubmitting,o=e.handleChange,s=e.handleBlur,c=e.handleSubmit;return l.a.createElement(F.a,{onSubmit:c,style:{marginTop:"70px",width:"300px"}},l.a.createElement(F.a.Item,{validateStatus:n.username&&a.username?"error":null,help:n.username&&a.username?a.username:null},l.a.createElement(G.a,{type:"text",id:"username",prefix:l.a.createElement(J.a,{type:"user"}),placeholder:"Enter a username",value:t.username,onChange:o,onBlur:s})),l.a.createElement(F.a.Item,{validateStatus:n.email&&a.email?"error":null,help:n.email&&a.email?a.email:null},l.a.createElement(G.a,{type:"email",id:"email",prefix:l.a.createElement(J.a,{type:"mail"}),placeholder:"Enter an email",value:t.email,onChange:o,onBlur:s})),l.a.createElement(F.a.Item,{validateStatus:n.password&&a.password?"error":null,help:n.password&&a.password?a.password:null},l.a.createElement(G.a,{type:"password",id:"password",prefix:l.a.createElement(J.a,{type:"lock"}),placeholder:"Enter a password",value:t.password,onChange:o,onBlur:s})),l.a.createElement(F.a.Item,null,l.a.createElement(A.a,{style:{width:"100%"},type:"primary",htmlType:"submit",disabled:r},"Sign up")))}))},K=function(){return l.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},l.a.createElement(z,null))},P=m.a.Header,Q=m.a.Content,W=function(e){var t=e.component,a=e.pathToRedirect,n=e.conditionFunc,r=Object(u.a)(e,["component","pathToRedirect","conditionFunc"]);return l.a.createElement(c.b,Object.assign({},r,{render:function(e){return n()?l.a.createElement(t,e):l.a.createElement(c.a,{to:a})}}))},Z=function(){var e=Object(i.c)((function(e){return e.userReducer})).loggedIn;return l.a.createElement(m.a,{className:"layout"},l.a.createElement(P,null,l.a.createElement("div",{className:"logo"}),l.a.createElement(N,null)),l.a.createElement(Q,null,l.a.createElement(c.d,null,l.a.createElement(c.b,{exact:!0,path:"/"},l.a.createElement(c.a,{to:"/home"})),l.a.createElement(W,{path:"/home",component:B,pathToRedirect:"/login",conditionFunc:function(){return e}}),l.a.createElement(c.b,{path:"/login",component:V}),l.a.createElement(c.b,{path:"/signup",component:K}))))},$=a(50),Y=a(241),ee=a(77),te=a(498),ae=JSON.parse(localStorage.getItem("user")),ne=ae?{loggedIn:!0,userData:ae}:{loggedIn:!1},re=Object(te.a)((n={},Object(ee.a)(n,_,(function(e,t){return{loggedIn:!0,user:t.payload.user}})),Object(ee.a)(n,T,(function(){return{loggedIn:!1}})),Object(ee.a)(n,U,(function(){return localStorage.removeItem("user"),{loggedIn:!1}})),n),ne),le=Object($.c)({userReducer:re}),oe=Object($.e)(le,Object($.d)(Object($.a)(Y.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));var se=function(){return l.a.createElement(i.a,{store:oe},l.a.createElement(c.c,{history:x},l.a.createElement(Z,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[245,1,2]]]);
//# sourceMappingURL=main.0bc07a4f.chunk.js.map